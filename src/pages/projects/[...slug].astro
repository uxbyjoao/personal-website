---
import { checkAuth } from "@utils";
import { getEntryBySlug } from "astro:content";

import BaseLayout from "@layouts/BaseLayout.astro";
const { slug } = Astro.params;
const project = await getEntryBySlug("projects", slug);
const { Content } = await project.render();

const cookie = Astro.cookies.get("auth_token").value;

if (!checkAuth(cookie)) {
  return Astro.redirect(`/login?redirect=${slug}`);
}
---

<BaseLayout>
  <Content />
</BaseLayout>
